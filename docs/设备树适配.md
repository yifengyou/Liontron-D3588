# 设备树适配

## eth0 网卡适配

```shell
// kdev: ethernet@fe1b0000 disabled
&gmac0 {
	status = "disabled";
};

// kdev: ethernet@fe1c0000 okay
&gmac1 {
	local-mac-address = [9a 6a 31 fa 44 f5];
	clock_in_out = "output";
	phy-handle = <&rgmii_phy>;
	phy-mode = "rgmii-rxid";
	pinctrl-0 = <&gmac1_miim
				 &gmac1_tx_bus2
				 &gmac1_rx_bus2
				 &gmac1_rgmii_clk
				 &gmac1_rgmii_bus>;
	pinctrl-names = "default";
	status = "okay";
};

// kdev: ethernet@fe1c0000 okay
&mdio1 {
	rgmii_phy: ethernet-phy@1 {
			/* RTL8211F */
			compatible = "ethernet-phy-id001c.c916",
						 "ethernet-phy-ieee802.3-c22";
			reg = <0x1>;
			pinctrl-names = "default";
			pinctrl-0 = <&rtl8211f_rst>;
			reset-assert-us = <15000>;
			reset-deassert-us = <50000>;
			reset-gpios = <&gpio3 RK_PB7 GPIO_ACTIVE_LOW>;
	};
};

// kdev: ethernet@fe1c0000 okay
&gmac1_stmmac_axi_setup {
	snps,blen = <0 0 0 0 16 8 4>;
	snps,wr_osr_lmt = <4>;
	snps,rd_osr_lmt = <8>;
};

// kdev: ethernet@fe1c0000 okay
&gmac1_mtl_rx_setup {
	snps,rx-queues-to-use = <2>;
	queue0 {};
	queue1 {};
};

// kdev: ethernet@fe1c0000 okay
&gmac1_mtl_tx_setup {
	snps,tx-queues-to-use = <2>;
	queue0 {};
	queue1 {};
};

```


## eth1网卡适配


* pcie网卡




cat /sys/kernel/debug/devices_deferred


```shell
[root@d3588-4g ~]# cat /sys/kernel/debug/devices_deferred
a40800000.pcie	rockchip-dw-pcie: missing PHY
[root@d3588-4g ~]#
```


















---